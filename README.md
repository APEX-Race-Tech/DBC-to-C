# DBC to C Code Generator

A PyQt5 GUI application that converts DBC (Database CAN) files to C code with message structures and pack/unpack functions.

## Quick Start

```bash
# Install dependencies
pip install -r requirements.txt

# Run the application
python dbc.py
```

## Usage

1. **Select DBC File** - Choose your .dbc file
2. **Generate Code** - Creates C header and source files
3. **Save Files** - Export `can_messages.h` and `can_messages.c`

## Example Output

### Header File (`can_messages.h`)
```c
// Auto-generated by ART_DBC-Code-Generator
#ifndef CAN_MESSAGES_H
#define CAN_MESSAGES_H
#include <stdint.h>

// Message: Engine_Data (ID: 0x100)
typedef struct {
    uint16_t rpm;        // scale=1, offset=0
    int8_t temperature;  // scale=1, offset=-40
    uint8_t load;        // scale=0.392, offset=0
} Engine_Data_t;

void unpack_Engine_Data(const uint8_t* data, Engine_Data_t* msg);
void pack_Engine_Data(const Engine_Data_t* msg, uint8_t* data);
#endif
```

### Source File (`can_messages.c`)
```c
// Auto-generated by ART_DBC-Code-Generator
#include "can_messages.h"

void unpack_Engine_Data(const uint8_t* data, Engine_Data_t* msg) {
    msg->rpm = (data[0] << 8) | data[1];
    msg->temperature = (int8_t)data[2];
    msg->load = data[3];
}

void pack_Engine_Data(const Engine_Data_t* msg, uint8_t* data) {
    data[0] = (msg->rpm >> 8) & 0xFF;
    data[1] = msg->rpm & 0xFF;
    data[2] = (uint8_t)msg->temperature;
    data[3] = msg->load;
}
```

## Features

- **Modern GUI** - Dark theme with syntax highlighting
- **DBC Parsing** - Loads and validates DBC files
- **C Code Generation** - Header and source files
- **Signal Scaling** - Handles scale/offset values
- **Error Handling** - Comprehensive validation

## Requirements

- Python 3.7+
- PyQt5
- cantools

## Arduino Example

Here's how to use the generated code in an Arduino project:

```cpp
#include "can_messages.h"

// CAN message structures
Engine_Data_t engine_msg;
uint8_t can_data[8];

void setup() {
  Serial.begin(115200);
  // Initialize CAN bus (example with MCP2515)
  // CAN.begin(CAN_500KBPS);
}

void loop() {
  // Example: Pack engine data
  engine_msg.rpm = 2500;
  engine_msg.temperature = 85;  // 85Â°C
  engine_msg.load = 75;         // 75% load
  
  pack_Engine_Data(&engine_msg, can_data);
  
  // Send CAN message
  // CAN.sendMsgBuf(0x100, 0, 8, can_data);
  
  // Example: Unpack received data
  uint8_t received_data[8] = {0x9C, 0x09, 0x55, 0x4B, 0x00, 0x00, 0x00, 0x00};
  Engine_Data_t received_msg;
  
  unpack_Engine_Data(received_data, &received_msg);
  
  Serial.print("RPM: "); Serial.println(received_msg.rpm);
  Serial.print("Temp: "); Serial.println(received_msg.temperature);
  Serial.print("Load: "); Serial.println(received_msg.load);
  
  delay(1000);
}
```

## Build Executable

```bash
pip install pyinstaller
pyinstaller --onefile --windowed dbc.py
```

## License

MIT License

